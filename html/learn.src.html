<script src="js/loopscript.js" type="text/javascript" charset="utf-8"></script>
<script src="js/lz-string-1.3.3-min.js" type="text/javascript" charset="utf-8"></script>

<style>

  h3 {
    margin-top: 30px;
  }

  p {
    white-space: pre-line;
  }

  .exOuter {
    margin-top: 10px;
    margin-bottom: 10px;
  }

  .exTitle {
    font-size: 0.8em;
    font-weight: 900;
  }

  .exCode {
    font-family: monospace;
    white-space: pre;
    border: 1px solid #eeeeee;
  }

  .comment {
    color: #ff0000;
  }
  .keyword {
    color: #0086B3;
    font-weight: 900;
  }
  .command {
    color: #0086B3;
  }
  .operator {
    color: #ff0000;
  }
  .pattern {
    color: #ff0000;
  }

  .exPlayer {
    font-size: 0.8em;
  }
</style>

<h1>Learning LoopScript</h1>

<ul>
<li><a href="#intro">Introduction</a></li>
<li><a href="#format">Format</a></li>
<li><a href="#tones">Tones</a></li>
</ul>

<a name="intro">&nbsp;</a>
<h3>Introduction</h3>

<p>LoopScript is a text format which allows you to describe sounds, and then usem in interesting loop patterns to make beats or melodies. You can then combine those loops into longer tracks to create songs. Any sound or pattern you create can be individually played or exported as a sound file.

Sounds are created using a simple declarative format. A 1.5 second C note might look like this in LoopScript:</p>

EXAMPLE 1.5 second C note:
tone introsound
  duration 1500
  note C
END

<p>This defines a new sound named "introsound". This sound can be referenced by name in other places in the LoopScript to be used as a source for loop patterns or other sound manipulation. When playing around on the website (such as <a href="play.html">the Playground</a>) or if not specified on the commandline, LoopScript will always just generate the last thing declared. The commandline version lets you specify a sound by name to generate if you just want to test the output of a sound without having to listen to the entire thing every time.

The rest of this page can be read/skimmed in order to see all of the features of LoopScript, or used as a reference via the table of contents above.</p>

<a name="format">&nbsp;</a>
<h3>Format</h3>

<p>LoopScript is pretty light on punctuation, and relies on line breaks an indents for most of its formatting. As in other formats/languages where indentation is significant, you can choose how much you want to indent each section provided that you are consistent (always use 2 space indents or a single tab indent, etc).

Most sounds are a type (such as "tone") followed by your name for it, followed by some indented lines which define its settings. Names cannot contain spaces, but are otherwise pretty loose. Keeping the names simple and terse is best as you'll be referencing them later in your LoopScripts.

Any setting you choose can be used outside of a sound declaration to change the default. For example, the <span class="command">bpm</span> setting ("beats per minute") is only meaningful to a <span class="keyword">loop</span> definition, but you can set it at top of your LoopScript to set the default bpm for any upcoming loops. You can also change it later in a global place and it'll only affect loops that haven't been declared yet. This works for any setting.

Comments are made with the hash mark ("<span class="comment">#</span>"), and continue to the end of the line.</p>

EXAMPLE Basic LoopScript format:
tone note1                          # Defines a new tone named "note1"
  duration 250                      # Length of tone, in milliseconds
  octave 4                          # Sets the octave for the note (0-8)
  note C                            # A-G are regular notes, H-L are the "black keys"

tone bass1                          # This begins a new tone (note the reset indentation)
  duration 250                      # New indent begins here
  octave 1
  note B

loop loop1                          # Loop declaration
  pattern note1 x.......x.......    # Uses note1
  pattern bass1 ....x.......x...    # Uses bass1
END

<a name="tones">&nbsp;</a>
<h3>Tones</h3>

<p>A <span class="keyword">tone</span> is a description of a single waveform:</p>

EXAMPLE A tone that uses all defaults:
tone example1
END

<script>
    var loopscript = require("./loopscript");
    function render(scriptText, outputID, showOutput, showSaveAs)
    {
      if(showOutput)
      {
        $('#output').css("display", "block");
      }
      var blobUrl = loopscript.render({
          script: scriptText,
          log: {
            verbose: function(text) {
              if(showOutput)
              {
                $('#output').append(text + "<br>");
                var o = document.getElementById("output");
                o.scrollTop = o.scrollHeight;
              }
            },
            error: function(text) {
              if(showOutput)
              {
                $('#output').append("<span class=\"error\">" + text + "</span><br>");
                var o = document.getElementById("output");
                o.scrollTop = o.scrollHeight;
              }
            }
          }
      });
      var html = "<audio src="+blobUrl+" controls preload=\"auto\" autobuffer></audio>";
      if(showSaveAs) {
        html += "<a href="+blobUrl+"><br>Right click here to Save As...</a>";
      }
      $(outputID).html(html);
    }
</script>

<!--
<div class="alert alert-info">
<strong>Heads up!</strong> This alert needs your attention, but it's not super important.
</div>
-->
